<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		k8sâ˜13é«˜çº§ç‰ˆè´Ÿè½½å‡è¡¡ingress | 
	 
	zyh
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "zyh.cool";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
	<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d8eaf4579517c8bea955331f62e2b380";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


<header id="header">
    <a id="title" href="/" class="logo">zyh</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
	

	

		<li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li>
		<li class="menu-item">
			<a href="https://github.com/wujun234" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="æŒ‰å›è½¦å…¨ç«™æœç´¢">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										web
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										fpm
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/b73a61bf/">
										fpmâ˜å®‰è£…-åŒ…ç®¡ç†æ–¹å¼
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3321a2dc/">
										fpmâ˜å®‰è£…-ç¼–è¯‘æ–¹å¼
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d1d65c30/">
										fpmâ˜é™æ€é…ç½®
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										nginx
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/58a1c0c7/">
										nginxâ˜fcgiä¸­aliasçš„ä½¿ç”¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4c513678/">
										nginxâ˜location
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/18de0eed/">
										nginxâ˜åŸºæœ¬è®¤è¯
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6209085/">
										nginxâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/445cf088/">
										nginxâ˜æ—¥å¿—åˆ‡å‰²
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/78ceb386/">
										nginxâ˜æ³›åŸŸå_å˜é‡æˆªå–
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/445cf088/">
										nginxâ˜é—®é¢˜é›†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å…¶å®ƒ
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/7c44c2e8/">
										webâ˜æœåŠ¡å™¨æ‰¿è½½èƒ½åŠ›è®¡ç®—
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ä¸­é—´ä»¶
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										rabbitmq
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/b43013ef/">
										rabbitmqâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å…¬æœ‰äº‘
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										aws
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/2e07203a/">
										awsâ˜EC2-GPUå®ä¾‹å®‰è£…æ˜¾å¡é©±åŠ¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/438aa722/">
										awsâ˜rds-mysqlå‚æ•°
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/604c5952/">
										awsâ˜rds-mysqlæ—¥å¿—
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2c5a64ff/">
										awsâ˜s3åˆå§‹åŒ–åˆ›å»º
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7cac5d21/">
										awsâ˜s3è·¨è´¦æˆ·è®¿é—®
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/ddc4c969/">
										awsâ˜åˆ©ç”¨cfæœåŠ¡åˆå§‹åŒ–awsç¯å¢ƒ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2e304ad6/">
										awsâ˜å›½å†…å¤–ä¹‹é—´è¿ç§»-AMI
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										é˜¿é‡Œäº‘
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/6df9bb76/">
										aliyunâ˜cliå®‰è£…å’ŒåŸºæœ¬è°ƒç”¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b5d7d6ee/">
										aliyunâ˜oss
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4cc38acc/">
										aliyunâ˜å¸¸è§é—®é¢˜
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å…¶å®ƒ
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										git
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/a38d0013/">
										gitlabâ˜å¤§ç‰ˆæœ¬è¿ç§»
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3f38f454/">
										gitlabâ˜å®‰è£…åŠå¤‡ä»½
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5edc3545/">
										gitlabâ˜æ‰¹é‡ä¿®æ”¹ç”¨æˆ·å¯†ç 
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f0c6f6c3/">
										gitâ˜å¸¸ç”¨å‘½ä»¤
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hexo
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/662e9d4d/">
										hexoâ˜å›¾ç‰‡æ˜¾ç¤º404é”™è¯¯çš„è§£å†³åŠæ³•
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f5c218d/">
										hexoâ˜æœ¬åœ°æœç´¢
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7c1abbe1/">
										openvpnâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/894f9595/">
										vsftpdâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3827a60a/">
										å·¥å…·åº“
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5290b79d/">
										ç½‘ç»œâ˜S5700é…ç½®æ”»å‡»æœ”æº
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6f53a6b8/">
										ç½‘ç»œâ˜é“¾è·¯èšåˆ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1ddb9d4e/">
										é—®é¢˜è®°å½•
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å®¹å™¨
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										docker
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/b7cf7b1f/">
										dockerâ˜01å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/604e367f/">
										dockerâ˜érootç”¨æˆ·æ‰§è¡Œç¨‹åº
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										harbor
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/9573a87d/">
										harborâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										helm
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/51015304/">
										helmâ˜01å…¥é—¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/710e3e49/">
										helmâ˜02chart
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										k8s
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/aaf9b7/">
										k8sâ˜01å¸¸è§æœ¯è¯­æ¦‚å¿µ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/9602dad/">
										k8sâ˜02å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/94518966/">
										k8sâ˜03pod
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3ec72f7e/">
										k8sâ˜04podé’©å­å‡½æ•°
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/9aa66899/">
										k8sâ˜05podæ¢æµ‹å™¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/18e4fa73/">
										k8sâ˜06æ— çŠ¶æ€æœåŠ¡deployment-podæ›´æ–°
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f6e328b5/">
										k8sâ˜07æ— çŠ¶æ€æœåŠ¡deployment-podæ‰©ç¼©
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d3b80b5f/">
										k8sâ˜08è´Ÿè½½å‡è¡¡service
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1080c6b6/">
										k8sâ˜09å­˜å‚¨èµ„æº
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4b0e4a5/">
										k8sâ˜09åº”ç”¨é…ç½®ä¸å¯†ç ä¸ä¿¡æ¯æä¾›
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4b0e4a5/">
										k8sâ˜10åº”ç”¨é…ç½®ä¸å¯†ç ä¸ä¿¡æ¯æä¾›
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/64fa9c84/">
										k8sâ˜11-1podèµ„æºçº¦æŸ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/ed4c29d5/">
										k8sâ˜11-2namespaceèµ„æºçº¦æŸ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/63d8d3d4/">
										k8sâ˜12-1å®ˆæŠ¤è¿›ç¨‹
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4bf29cf0/">
										k8sâ˜12-2æœ‰çŠ¶æ€æœåŠ¡StatefulSet
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/posts/7627a41d/">
										k8sâ˜13é«˜çº§ç‰ˆè´Ÿè½½å‡è¡¡ingress
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/a5ed67a6/">
										k8sâ˜14è®¤è¯æˆæƒ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/55da993d/">
										k8sâ˜15è¯ä¹¦ç®¡ç†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7538d100/">
										k8sâ˜16kubeadmé›†ç¾¤å‡çº§
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/932d1f08/">
										k8sâ˜17nodeæ±¡æŸ“å’Œpodå®¹å¿
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3511df2/">
										k8sâ˜18æ—¥å¿—æ”¶é›†ç³»ç»Ÿ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/c15432fa/">
										k8sâ˜kubectlå¤šé›†ç¾¤ç®¡ç†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/9a7bc037/">
										k8sâ˜showdocéƒ¨ç½²
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e1096625/">
										k8sâ˜è®°å½•ç‚¹
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										æ•°æ®åº“
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										mysql
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/b824edd8/">
										mysqlâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e6ae9474/">
										mysqlâ˜å¸¸ç”¨å‘½ä»¤
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/c83ca575/">
										mysqlâ˜ç¦»çº¿è¿ç§»è„šæœ¬
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										redis
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/2c2d50a0/">
										redisâ˜å¤‡ä»½
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/65ab632a/">
										redisâ˜å®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/28361833/">
										redisâ˜è·å–æ²¡æœ‰è®¾ç½®ttlçš„key
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/28361833/">
										redisâ˜è°ƒæ•´å†…æ ¸å‚æ•°
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										æ—¥å¿—
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ELK
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/95177ce7/">
										æ—¥å¿—â˜EFKç®€å•éƒ¨ç½²-k8s
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3475106c/">
										æ—¥å¿—â˜ELKç®€å•éƒ¨ç½²-å®¹å™¨æ–¹å¼
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å…¶å®ƒ
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/421d605e/">
										æ—¥å¿—â˜logrotateå®‰è£…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ç›‘æ§
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										prometheus
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/65820315/">
										prometheusâ˜01æ­å»º
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e172b6e2/">
										prometheusâ˜02å¤–ç½®prometheusç›‘æ§k8s
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/bced4977/">
										prometheusâ˜03k8så†…ç½®éƒ¨ç½²
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/978d0c1d/">
										prometheusâ˜04redisç›‘æ§
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6178b477/">
										prometheusâ˜05mysqlç›‘æ§
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7fd13722/">
										prometheusâ˜06rabbitmqç›‘æ§
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										zabbix
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/3d20f83e/">
										zabbixâ˜WEBç›‘æ§
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1587f6e8/">
										zabbixâ˜agentå’Œproxy(yum)
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b35b5965/">
										zabbixâ˜nginx
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6c093771/">
										zabbixâ˜redis
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/ed865d2f/">
										zabbixâ˜serverå®‰è£…æ³¨æ„äº‹é¡¹
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/25f36846/">
										zabbixâ˜å®¹å™¨æ­å»º
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4ebbd3a8/">
										zabbixâ˜é¢„è­¦
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å…¶å®ƒ
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/ae41ae33/">
										ç›‘æ§â˜monit
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/ab1247fb/">
										ç›‘æ§â˜mysqlæ…¢sqlé¢„è­¦
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8c33f887/">
										ç›‘æ§â˜ä¼ä¸šå¾®ä¿¡æœºå™¨äºº
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f9b08c30/">
										ç›‘æ§â˜å¾®ä¿¡é¢„è­¦
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1fac36d/">
										ç›‘æ§â˜è¿œç¨‹ç£ç›˜æ£€æµ‹
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f8f9b4d0/">
										ç›‘æ§â˜é‚®ä»¶é¢„è­¦
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ç³»ç»Ÿ
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										linux
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/13364d65/">
										linuxâ˜centos7é‡ç½®rootå¯†ç 
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/a3dfc0e8/">
										linuxâ˜dfä¸duæ•°æ®ä¸ä¸€è‡´çš„åŸå› 
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5db0cd07/">
										linuxâ˜ssh-MFAè‡ªåŠ¨ç™»é™†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e4f7ce4c/">
										linuxâ˜ubuntu20-04çº¯å‘½ä»¤è¡Œç½‘å¡é…ç½®
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7b3cf3d8/">
										linuxâ˜ä½¿ç”¨expectè‡ªåŠ¨ç™»å½•sshåè¿œç¨‹ä¼šè¯ä¸ä¼šè·Ÿéšæœ¬åœ°ä¼šè¯ç¼©æ”¾çš„é—®é¢˜
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d2fed0bf/">
										linuxâ˜åˆ©ç”¨acme-shç®¡ç†å…è´¹çš„sslè¯ä¹¦ç”³è¯·
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/cd32aa48/">
										linuxâ˜æ—¶é—´
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f41d0763/">
										linuxâ˜ç³»ç»Ÿå†…æ ¸ä¼˜åŒ–
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/a7611bc1/">
										linuxâ˜è½¯raidåˆ›å»º
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3988a5f2/">
										linuxâ˜è¾“å‡ºä¸ªæ€§åŒ–å¼€æœºçŠ¶æ€
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										windows
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/348cba53/">
										windows-wsl dnså¼‚å¸¸
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/22b82d75/">
										windows-åŒ…ç®¡ç†å·¥å…·-scoop
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/88eb7b6/">
										windowsâ˜win10è¿ç§»æ•°æ®
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										è‡ªåŠ¨åŒ–
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ansible
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/15aa7d2e/">
										ansibleâ˜playbook-aws
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b0929188/">
										ansibleâ˜playbook-handle
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6ce01f58/">
										ansibleâ˜playbook-include
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/25732c33/">
										ansibleâ˜playbook-lookupæ’ä»¶
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/960fc783/">
										ansibleâ˜playbook-tags
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4235ddf4/">
										ansibleâ˜playbook-å˜é‡
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/14bc184e/">
										ansibleâ˜playbook-å¾ªç¯
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/29683589/">
										ansibleâ˜playbook-æ¡ä»¶åˆ¤æ–­
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f43dca37/">
										ansibleâ˜playbook-è¿‡æ»¤å™¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/c4126d5a/">
										ansibleâ˜playbook-é”™è¯¯æ•è·
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d3e413b7/">
										ansibleâ˜åŸºç¡€ä¿¡æ¯
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1e274151/">
										ansibleâ˜å¸¸ç”¨æ¨¡å—-å‘½ä»¤è°ƒç”¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4235ddf4/">
										ansibleâ˜å¸¸ç”¨æ¨¡å—-æ–‡æœ¬æ–‡ä»¶æ“ä½œ
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/84eb900/">
										ansibleâ˜å¸¸ç”¨æ¨¡å—-ç³»ç»Ÿç›¸å…³
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3d9b9ec1/">
										ansibleâ˜å¸¸ç”¨æ¨¡å—-è½¯ä»¶åŒ…ç®¡ç†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/724fda19/">
										ansibleâ˜æ¨¡æ¿
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/720afd15/">
										ansibleâ˜è§’è‰²
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										jenkins
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/3e0f2183/">
										jenkinsâ˜ä»å®¹å™¨ä¸­è®¿é—®å®¿ä¸»æœºdockerå‘½ä»¤
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3b5cd3e1/">
										jenkinsâ˜åŠ¨æ€agent
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d9cdb70/">
										jenkinsâ˜å®‰è£…å’ŒåŸºæœ¬é…ç½®
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										è™šæ‹ŸåŒ–
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										vmware
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/eab024cf/">
										vcsaâ˜å­˜å‚¨è®¾å¤‡æœ‰vmfsåˆ†åŒºï¼Œä½†æ•°æ®å­˜å‚¨ä¸¢å¤±
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										è¯­è¨€
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										css
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/fa5680b3/">
										cssâ˜èƒŒæ™¯å›¾å±…ä¸­æ‹‰ä¼¸å¹³é“º
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										go
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/759b68d8/">
										goâ˜001å˜é‡
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8c3e952e/">
										goâ˜002å¸¸é‡
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1a034363/">
										goâ˜003è¿ç®—ç¬¦
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8a6b5455/">
										goâ˜004æ¡ä»¶è¯­å¥
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/98f86e16/">
										goâ˜005å‡½æ•°
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/318675c1/">
										goâ˜006å‡½æ•°-é—­åŒ…
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f8eb4b1b/">
										goâ˜007å‡½æ•°-æ–¹æ³•
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/a705a91a/">
										goâ˜008ç»“æ„ä½“
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/77a46e91/">
										goâ˜009æ¥å£
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/336ec0ac/">
										goâ˜010é”™è¯¯å¤„ç†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2dab3d00/">
										goâ˜011å¼‚å¸¸å¤„ç†
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d1503f4a/">
										goâ˜012å¸¸ç”¨æ¨¡å—
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										java
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/ac6b3b36/">
										jdkâ˜å®‰è£…å’Œé…ç½®
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										jquery
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/5d527900/">
										jqueryâ˜ä¼ªè¿›åº¦æ¡
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										python
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/86059ffb/">
										djangoâ˜adminç®¡ç†è§†å›¾
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/dd4c9efa/">
										djangoâ˜restfulç®€å•ä½¿ç”¨
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/26bd5165/">
										djangoâ˜æ—¥å¿—
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6a4df400/">
										djangoâ˜ç®¡ç†é™æ€æ–‡ä»¶
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3f8b5448/">
										djangoâ˜è®°å¿†ç‚¹
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d60c38c/">
										djangoâ˜éªŒè¯ç 
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/876c5852/">
										pythonâ˜json
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										shell
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/241ce96c/">
										shellâ˜ifåˆ¤å®š
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b06f599c/">
										shellâ˜readåµŒå¥—
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- å¼•å…¥æ­£æ–‡ -->
	<div id="content">
		<h1 id="article-title">

	k8sâ˜13é«˜çº§ç‰ˆè´Ÿè½½å‡è¡¡ingress
</h1>
<div class="article-meta">
	
		<span>
			é˜…è¯»é‡:<span id="/posts/7627a41d/" class="leancloud_visitors" data-flag-title="k8sâ˜13é«˜çº§ç‰ˆè´Ÿè½½å‡è¡¡ingress"></span>
		</span>
	
	<span>zyh</span>
	<span>2020-09-22 18:30:04</span>
		<div id="article-categories">
    
		<span>Categoriesï¼š</span>
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true">
                        <a href="/categories/å®¹å™¨/">å®¹å™¨</a>
                        </i>
                      
                        >
                      
                    </span>
                
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true">
                        <a href="/categories/å®¹å™¨/k8s/">k8s</a>
                        </i>
                      
                    </span>
                
            
    

    
		<span>Tagsï¼š</span>
            
                
                    <span>
                        <i class="fa fa-tag" aria-hidden="true">
                        <a href="/tags/k8s/">k8s</a>
                        </i>
                    </span>
                
            
                
                    <span>
                        <i class="fa fa-tag" aria-hidden="true">
                        <a href="/tags/å®¹å™¨/">å®¹å™¨</a>
                        </i>
                    </span>
                
            
                
                    <span>
                        <i class="fa fa-tag" aria-hidden="true">
                        <a href="/tags/ingress/">ingress</a>
                        </i>
                    </span>
                
            
    
		</div>

</div>

<div id="article-content">
	<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ingress å¯ä»¥æä¾›è´Ÿè½½å‡è¡¡/SSLç®¡ç†/è™šæ‹Ÿå‘½åä¸»æœº/pathè·¯ç”±. å®ƒçš„ç›®çš„æ˜¯å¢åŠ 7å±‚æµé‡åˆ†å‘ç­‰è´Ÿè½½åŠŸèƒ½. ä½ å¯ä»¥é€šè¿‡ Ingress å°†è¯·æ±‚è½¬å‘åˆ°å„ä¸ª Service å¯¹è±¡.</p>
<p>ä½†æ˜¯ingressæœ¬èº«å¹¶ä¸æ˜¯è§„åˆ™çš„æ‰§è¡Œè€…. å®ƒåªæ˜¯è®°å½•è§„åˆ™, è§„åˆ™æ‰§è¡Œè€…ç”±ingress-controllerå®ç°.</p>
<p>ingress-controller çš„å®ç°æœ‰å¾ˆå¤šï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹é¡µé¢</p>
<p><a target="_blank" rel="noopener" href="https://kubernetes.io/zh/docs/concepts/services-networking/ingress-controllers/">https://kubernetes.io/zh/docs/concepts/services-networking/ingress-controllers/</a></p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>nginx ingress åŸºäº nginx çš„ ingress æ§åˆ¶å™¨</li>
<li>istio ingress åŸºäº istio çš„ ingress æ§åˆ¶å™¨</li>
<li>traefik ingress åŸºäº traefik çš„ ingress æ§åˆ¶å™¨</li>
</ul>
<h2 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h2>
<ul>
<li>
<p>ingress æä¾›è§„åˆ™, å®ƒéœ€è¦å’Œåç«¯ä¸šåŠ¡ä½äºåŒä¸€ä¸ªnsä¸­.</p>
</li>
<li>
<p>ingress controller å®ç°è§„åˆ™, å®ƒå¯ä»¥å•ç‹¬æ˜¯ä¸€ä¸ªns.å› ä¸ºå®ƒä¼šè‡ªåŠ¨å»æ‰¾é‚£äº›æ³¨è§£å«æœ‰è‡ªå·±çš„ingress.</p>
</li>
<li>
<p>ingress é’ˆå¯¹çš„ä¸»è¦æ˜¯ http å’Œ https. è¿™äº›ä¹‹å¤–çš„ç«¯å£æš´æ¼ä½ åº”è¯¥ä½¿ç”¨ Service.Type=NodePort æˆ–è€… Service.Type=LoadBalancer</p>
</li>
</ul>
<h2 id="æµé‡è·¯å¾„">æµé‡è·¯å¾„</h2>
<p>internet =&gt; Ingress =&gt; Service</p>
<p><img src="/posts/7627a41d/image-20201023110559218.png" alt="image-20201023110559218"></p>
<h2 id="ingress">ingress</h2>
<p><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/services-networking/ingress/">https://kubernetes.io/docs/concepts/services-networking/ingress/</a></p>
<h3 id="ä»¥nginx-ingressæ§åˆ¶å™¨æ¥æ„å»ºä¸€ä¸ªä¾‹å­">ä»¥nginx ingressæ§åˆ¶å™¨æ¥æ„å»ºä¸€ä¸ªä¾‹å­</h3>
<p>client =&gt; <a target="_blank" rel="noopener" href="http://one.foo.com/one">http://one.foo.com/one</a> =&gt; Ingress = &gt; Service(one):8001 =&gt; pod</p>
<p>client =&gt; http://*.foo.com/other =&gt; Ingress  =&gt; Service(other):8002 =&gt; pod</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸‹åˆ— ingress é…ç½®ä¸­ï¼Œé€šè¿‡ annotations æ³¨è§£æ¥è°ƒç”¨ nginx ingress æ§åˆ¶å™¨ã€‚ä¸åŒçš„ ingress æ§åˆ¶å™¨çš„æ³¨è§£é…ç½®æœ‰æ‰€ä¸åŒï¼Œå…·ä½“ä»¥æ§åˆ¶å™¨æœ¬èº«è¯´æ˜æ–‡æ¡£ä¸ºåŸºå‡†ã€‚</p>
<pre><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: minimal-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - host: one.foo.com
    http:
      paths:
      - path: /one
        pathType: Prefix
        backend:
          service:
            name: one
            port:
              number: 8001
  - host: &quot;*.foo.com&quot;
    http:
      paths:
      - pathType: Prefix
        path: &quot;/other&quot;
        backend:
          service:
            name: other
            port:
              number: 8002
</code></pre>
<p>ğŸŒŸè¯·æ³¨æ„, <code>networking.k8s.io/v1</code>å¿…é¡»æ˜¯v1.19+æ‰å¯ä»¥ä½¿ç”¨, å¦‚æœä½ ä¸æ˜¯,åˆ™åº”è¯¥ä½¿ç”¨<code>networking.k8s.io/v1beta1</code></p>
<p>ä¸ºäº†æ–¹ä¾¿ç†è§£ ingress çš„é…ç½®é¡¹ï¼Œæˆ‘å‚è€ƒ nginx é…ç½®ï¼Œæ¥è¿›è¡Œäº†ä¸€äº›æ¨ªå‘å¯¹æ¯”ï¼š</p>
<p>nginx.servername:  è¿™é‡Œæ˜¯ spec.rules[].host</p>
<p>nginx.location: è¿™é‡Œæ˜¯ spec.rules.http.paths[].path</p>
<p>nginx.upstream: è¿™é‡Œæ˜¯ spec.rules.http.paths[].backend</p>
<h3 id="å…³äº-spec-rules-host">å…³äº spec.rules[].host</h3>
<p>è¿™é‡Œæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹. host æ”¯æŒç»Ÿé…åŒ¹é…. ä¸è¿‡ <code>*</code>ä¸èƒ½è·¨çº§åŒ¹é…. ä¾‹å¦‚,</p>
<p>*.abc.com å¯ä»¥åŒ¹é… <a target="_blank" rel="noopener" href="http://one.abc.com">one.abc.com</a> ä½†æ˜¯ä¸èƒ½åŒ¹é… <a target="_blank" rel="noopener" href="http://two.one.abc.com">two.one.abc.com</a>.</p>
<h3 id="å…³äº-spec-rules-http-paths-path">å…³äº spec.rules.http.paths[].path</h3>
<p>è¿™é‡Œæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹.å¦‚ä¸Šä¾‹å­æ‰€è¿°. pathType å®šä¹‰äº† path çš„ç±»å‹. å®ƒæœ‰ä¸‰ä¸ªç±»å‹:</p>
<ul>
<li>
<p>ImplementationSpecific: å·²ingress classä¸ºåŸºå‡†. å…·ä½“å¦‚ä½•åŒ¹é…,éœ€è¦çœ‹é€‰ç”¨çš„ingress class.è¿™æ˜¯é»˜è®¤çš„.</p>
</li>
<li>
<p>Exact: ä¸¥æ ¼åŒ¹é…. ä¸èƒ½æœ‰ä¸€ç‚¹ä¸åŒ.</p>
</li>
<li>
<p>Prefix: åŸºäº&quot;/&quot;åˆ†æ®µè¿›è¡Œå‰ç¼€åŒ¹é…. ä¾‹å¦‚,</p>
<ul>
<li>/aaa/bbb å¯ä»¥åŒ¹é…ä»»ä½• /aaa/bbb/ å¼€å¤´çš„, æˆ–è€… /aaa/bbb.  å› æ­¤ /aaa/bbbb æ˜¯ä¸èƒ½åŒ¹é…çš„.</li>
<li>/aaa å¯ä»¥åŒ¹é…ä»»ä½• /aaa/ å¼€å¤´çš„, æˆ–è€… /aaa. å› æ­¤, /aaaa æ˜¯ä¸èƒ½åŒ¹é…çš„.</li>
<li>/ å¯ä»¥åŒ¹é…ä»»ä½• / å¼€å¤´çš„. å› æ­¤, åŒ¹é…æ‰€æœ‰.</li>
</ul>
<p>â­ï¸è¯·æ³¨æ„, Prefix ç±»å‹ä¸‹.ä½ å†™çš„åŒ¹é…å­—ç¬¦ä¸²é¦–å°¾éƒ½éœ€è¦åŠ <code>/</code>, å¦‚æœä½ å°¾éƒ¨æ²¡æœ‰åŠ <code>/</code>, é‚£ä¹ˆ ingress åœ¨åŒ¹é…çš„æ—¶å€™, ä¹Ÿä¼šå¸®ä½ åŠ ä¸Š<code>/</code>.</p>
</li>
</ul>
<p>å½“Exactå’ŒPrefixæ··ç”¨çš„æ—¶å€™, å¦‚æœä¸€ä¸ªè¯·æ±‚åŒæ—¶åŒ¹é…äº†è¿™ä¸¤ä¸ªç±»å‹ä¸‹çš„path, é‚£ä¹ˆExact ä¼˜å…ˆçº§æ›´é«˜.</p>
<h3 id="æ„å»ºTLS">æ„å»ºTLS</h3>
<ol>
<li>
<h4 id="åˆ›å»º-Secret-å¯¹è±¡-å¯¼å…¥è¯ä¹¦æ–‡ä»¶">åˆ›å»º Secret å¯¹è±¡, å¯¼å…¥è¯ä¹¦æ–‡ä»¶</h4>
<pre><code class="language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: foo-com-tls
  namespace: default
data:
  tls.crt: base64 encoded cert # è¿™é‡Œéœ€è¦å¡«å†™ base64 ç¼–ç åçš„ cert å†…å®¹. tls.crt ä¸å¯æ›´å
  tls.key: base64 encoded key  # è¿™é‡Œéœ€è¦å¡«å†™ base64 ç¼–ç åçš„ key å†…å®¹. tls.key ä¸å¯æ›´å
type: kubernetes.io/tls
</code></pre>
</li>
<li>
<h4 id="åœ¨Ingresså¯¹è±¡ä¸­è°ƒç”¨-Secret">åœ¨Ingresså¯¹è±¡ä¸­è°ƒç”¨ Secret</h4>
<pre><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: tls-example-ingress
spec:
  tls:
  - hosts:
      - https-example.foo.com
    secretName: foo-com-tls
  rules:
  - host: https-example.foo.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: service1
            port:
              number: 80
</code></pre>
</li>
</ol>
<p>é€šè¿‡é…ç½®æ–‡ä»¶, å¯ä»¥çœ‹å‡ºæ¥åŠ å¯†åˆ°Ingresså°±åœæ­¢äº†(åç«¯Serviceå¯¹è±¡service1çš„ç«¯å£æ˜¯80).è¿™ä¹Ÿç¬¦åˆæˆ‘ä»¬åœ¨ék8sç¯å¢ƒä¸­çš„æµç¨‹.</p>
<p>å¦å¤–, ä¸åŒçš„Ingressæ§åˆ¶å™¨å¯¹äºTLSè¿™å—ä¹Ÿæœ‰ä¸€å®šå·®å¼‚.å…·ä½“ä»¥æ§åˆ¶å™¨æœ¬èº«è¯´æ˜ä¸ºå‡†.</p>
<h2 id="Ingress-controller">Ingress controller</h2>
<p><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/</a></p>
<p>Ingress æƒ³è¦æ­£å¸¸è¿ä½œ, éœ€è¦Ingressæ§åˆ¶å™¨çš„æ”¯æŒ.</p>
<p>ä½ å¯ä»¥åœ¨k8sä¸­éƒ¨ç½²å¤šä¸ªIngressæ§åˆ¶å™¨, ä½†æ˜¯ä½ éœ€è¦é€šè¿‡åœ¨ annotations ä¸­ç”¨ ingress.class æ³¨è§£å¼ºè°ƒä½ æƒ³ç”¨å“ªä¸€æ¬¾.</p>
<p>å°±åƒä¸‹é¢è¿™æ ·</p>
<pre><code class="language-yaml">apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
  name: example
  namespace: foo
spec:
  rules:
    - host: www.example.com
      http:
        paths:
          - backend:
              serviceName: exampleService
              servicePort: 80
            path: /
  # This section is only required if TLS is to be enabled for the Ingress
  tls:
      - hosts:
          - www.example.com
        secretName: example-tls
---
apiVersion: v1
kind: Secret
metadata:
  name: example-tls
  namespace: foo
data:
  tls.crt: &lt;base64 encoded cert&gt;
  tls.key: &lt;base64 encoded key&gt;
type: kubernetes.io/tls
</code></pre>
<p>è¿™é‡Œ<code>backend</code>æ˜¯æ—§å†™æ³•ï¼Œä½ åº”è¯¥ä½¿ç”¨æ–°çš„å†™æ³•ï¼š</p>
<pre><code class="language-yaml">  backend:
    service:
      name: exampleService
      port:
        number: 80
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬é€‰ç”¨ nginx ingress æ§åˆ¶å™¨ã€‚å®ƒçš„éƒ¨ç½²æ–‡æ¡£æ˜¯: <a target="_blank" rel="noopener" href="https://github.com/kubernetes/ingress-nginx/blob/master/docs/deploy/index.md">https://github.com/kubernetes/ingress-nginx/blob/master/docs/deploy/index.md</a> æˆ–è€… <a target="_blank" rel="noopener" href="https://kubernetes.github.io/ingress-nginx/deploy/">https://kubernetes.github.io/ingress-nginx/deploy/</a></p>
<p>è¿™é‡Œï¼Œæˆ‘å°†é€šè¿‡helmæ¥å®‰è£…ingress-nginx. (ä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶å®ƒå®‰è£…æ–¹å¼. åœ¨ <a target="_blank" rel="noopener" href="https://kubernetes.github.io/ingress-nginx/deploy/">https://kubernetes.github.io/ingress-nginx/deploy/</a> ä¸­å¯ä»¥æ‰¾åˆ°å¾ˆå¤šä¸åŒç¯å¢ƒçš„å®‰è£…æ–¹å¼. )</p>
<h3 id="helm-å®‰è£…">helm å®‰è£…</h3>
<p>è¿™é‡Œæ˜¯ helm çš„å®‰è£…æ–‡æ¡£: <a target="_blank" rel="noopener" href="https://helm.sh/docs/intro/install/">https://helm.sh/docs/intro/install/</a></p>
<p>å½“å‰å®ƒçš„å®‰è£…æ–¹å¼åº”è¯¥æ˜¯:</p>
<pre><code class="language-bash">curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
</code></pre>
<h3 id="nginx-ingress-å®‰è£…">nginx ingress å®‰è£…</h3>
<p>å½“å‰ ingress-nginx çš„ä»“åº“åœ°å€æ˜¯: <a target="_blank" rel="noopener" href="https://hub.helm.sh/charts/ingress-nginx/ingress-nginx">https://hub.helm.sh/charts/ingress-nginx/ingress-nginx</a> ä½ å¯ä»¥åœ¨è¿™é‡Œç›´æ¥æ‰¾åˆ°å®‰è£…å‘½ä»¤</p>
<pre><code class="language-bash">helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm repo add stable https://kubernetes-charts.storage.googleapis.com/
helm repo update
kubectl create namespace ingress-nginx
## å®‰è£…
helm install ingress-nginx ingress-nginx/ingress-nginx -n ingress-nginx
## å‡çº§
helm upgrade ingress-nginx ingress-nginx/ingress-nginx -n ingress-nginx --install
## è‡ªå®šä¹‰é…ç½®å®‰è£…
helm show values ingress-nginx/ingress-nginx &gt; ingress-nginx.yaml
helm install ingress-nginx ingress-nginx/ingress-nginx -f ingress-nginx.yaml -n ingress-nginx
</code></pre>
<pre><code class="language-bash">kubectl get all -n ingress-nginx
===
NAME                                            READY   STATUS    RESTARTS   AGE
pod/ingress-nginx-controller-5886685d54-hf6l6   1/1     Running   0          68m

NAME                                         TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                      AGE
service/ingress-nginx-controller             LoadBalancer   10.96.210.139   &lt;pending&gt;     80:32489/TCP,443:30936/TCP   68m
service/ingress-nginx-controller-admission   ClusterIP      10.96.128.101   &lt;none&gt;        443/TCP                      68m

NAME                                       READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/ingress-nginx-controller   1/1     1            1           68m

NAME                                                  DESIRED   CURRENT   READY   AGE
replicaset.apps/ingress-nginx-controller-5886685d54   1         1         1       68m
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° ingress-nginx æ§åˆ¶å™¨åˆ›å»ºäº†ä¸€ä¸ª pod, è¿™ä¸ª pod å…¶å®å°±æ˜¯ä¸€ä¸ª nginx. å®ƒé€šè¿‡æ¥æ”¶ ingress å®šä¹‰çš„è§„åˆ™, æ¥åŠ¨æ€çš„å˜æ›´nginxé…ç½®,ä»è€Œæ­£ç¡®çš„å°†æµé‡è½¬å‘ç»™åç«¯åº”ç”¨çš„serviceå¯¹è±¡.</p>
<pre><code class="language-bash">kubectl describe pod/ingress-nginx exec -it pod/ingress-nginx-controller-5886685d54-hf6l6
===
    Requests:
      cpu:      100m
      memory:   90Mi
</code></pre>
<p>å½“å‰é…ç½®é»˜è®¤æ²¡æœ‰åšlimité™åˆ¶. æ‰€ä»¥éœ€è¦å…³æ³¨ingress-nginxåˆ›å»ºçš„podæ‰€åœ¨ç‰©ç†èŠ‚ç‚¹çš„æ€§èƒ½æ˜¯å¦å¯ä»¥æ»¡è¶³. å»ºè®®å¼ºåˆ¶ç»‘å®šåˆ°å¤šä¸ªnodeèŠ‚ç‚¹, è¿™æ‰¹èŠ‚ç‚¹ä¸“é—¨è·‘ç”¨æ¥è¿›è¡Œingressæ§åˆ¶å™¨.</p>
<pre><code class="language-bash">kubectl --namespace ingress-nginx exec -it pod/ingress-nginx-controller-5886685d54-hf6l6 -- /bin/bash
==
cat /etc/nginx/nginx.conf
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ingress-nginxä¼šåŠ¨æ€çš„åŠ è½½ingresså®šä¹‰çš„è·¯ç”±è§„åˆ™.</p>
<p>æœ€å, æˆ‘ä»¬å¯èƒ½æœ€éœ€è¦å…³æ³¨çš„æ˜¯ <code>service/ingress-nginx-controller</code> å¯¹è±¡. å› ä¸ºå®ƒçš„ç±»å‹å†³å®šäº†, æˆ‘ä»¬å¦‚ä½•è§£æå°†è¦æš´æ¼çš„æœåŠ¡åŸŸå.</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡helmé»˜è®¤å®‰è£…çš„ ingress crotroller çš„ Service å¯¹è±¡æ˜¯LoadBalancerç±»å‹. è¿™ç§ç±»å‹æˆ‘ä»¬ä¸€èˆ¬æ˜¯ç”¨äºäº‘ç«¯ç¯å¢ƒçš„. è€Œæˆ‘è¿™é‡Œæµ‹è¯•ç¯å¢ƒæ˜¯è£¸æœº,å› æ­¤ä½ å¯ä»¥çœ‹åˆ°è¿™é‡Œå®ƒä¸€ç›´æ— æ³•è·å–åˆ°<code>EXTERNAL-IP</code>.</p>
<p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜.k8så®˜æ–¹æ–‡æ¡£è¿™é‡Œæä¾›äº†å¤šç§è£¸æœºå®‰è£…ä¸‹çš„è§£å†³æ–¹æ¡ˆ. <a target="_blank" rel="noopener" href="https://kubernetes.github.io/ingress-nginx/deploy/baremetal/">https://kubernetes.github.io/ingress-nginx/deploy/baremetal/</a></p>
<p>æˆ‘ä»¬è¿™é‡Œé€šè¿‡ <a target="_blank" rel="noopener" href="https://kubernetes.github.io/ingress-nginx/deploy/baremetal/#a-pure-software-solution-metallb">https://kubernetes.github.io/ingress-nginx/deploy/baremetal/#a-pure-software-solution-metallb</a> æ–¹æ¡ˆæ¥è§£å†³ LB ç±»å‹çš„ <code>EXTERNAL-IP</code>è·å–é—®é¢˜. å…¶å®ƒæ–¹æ¡ˆå¹¶ä¸æ˜¯é‡‡ç”¨çš„ LB ç±»å‹, å› æ­¤è¿™é‡Œä¸å†å™è¯´.</p>
<p>âš ï¸metallb æ–¹æ¡ˆåœ¨å½“å‰å¹¶ä¸æ˜¯ä¸€ä¸ªæˆç†Ÿçš„æ–¹æ¡ˆ,å½“ç„¶å®ƒåº”è¯¥æ˜¯å¯ç”¨çš„ğŸ˜„ æ‰€ä»¥ç”¨äºæœ¬åœ°æµ‹è¯•ç¯å¢ƒæ˜¯å¯ä»¥çš„. çº¿ä¸Šç¯å¢ƒå»ºè®®ç›´æ¥ç”¨äº‘æœåŠ¡çš„LBå³å¯.</p>
<h2 id="metallb">metallb</h2>
<p><a target="_blank" rel="noopener" href="https://metallb.universe.tf/installation/#installation-with-helm">https://metallb.universe.tf/installation/#installation-with-helm</a></p>
<p>metallb æ¨¡æ‹Ÿäº†äº‘ç¯å¢ƒä¸­çš„è´Ÿè½½å‡è¡¡å™¨åŠŸèƒ½.</p>
<p>ğŸŒŸIf youâ€™re using kube-proxy in IPVS mode, since Kubernetes v1.14.2 you have to enable strict ARP mode.</p>
<p>å¦‚æœä½ æ˜¯ipvs ä¸” k8s ç‰ˆæœ¬åœ¨1.14.2ä»¥ä¸Š, é‚£ä¹ˆä½ éœ€è¦å¯åŠ¨ä¸¥æ ¼arpæ¨¡å¼.</p>
<pre><code class="language-bash">kubectl edit configmap -n kube-system kube-proxy
===
ipvs:
  strictARP: true
</code></pre>
<p>å¼€å§‹å®‰è£…</p>
<pre><code class="language-bash">helm repo add metallb https://metallb.github.io/metallb
helm fetch metallb metallb/metallb
</code></pre>
<p>ä¿®æ”¹ metalla/values.yaml, æ·»åŠ åœ°å€æ± ï¼Œç”¨æ¥ç»™svcä¸‹å‘ipã€‚è¯·è®°ä½, è¿™äº›åœ°å€å¿…é¡»æ˜¯æ²¡æœ‰è¢«å…¶å®ƒèµ„æºå ç”¨çš„.</p>
<pre><code class="language-bash">configInline:
  address-pools:
   - name: default
     protocol: layer2
     addresses:
     - 10.200.16.11 - 10.200.16.19
</code></pre>
<p>é€šè¿‡ helm å®‰è£…</p>
<pre><code class="language-bash">kubectl create ns metallb-system
helm install metallb --namespace metallb-system -f metallb/values.yaml metallb/metallb
# ä¸‹é¢è¿™ä¸ªå‘½ä»¤ä»…åœ¨ä½ åˆå§‹å®‰è£…çš„æ—¶å€™éœ€è¦è¿è¡Œ
kubectl create secret generic -n metallb-system memberlist --from-literal=secretkey=&quot;$(openssl rand -base64 128)&quot;
</code></pre>
<p>ä¸‹é¢,è®©æˆ‘ä»¬å†çœ‹çœ‹ ingress crotroller çš„ svc å¯¹è±¡ä¿¡æ¯.</p>
<pre><code class="language-bash">kubectl get svc -n ingress-nginx
===
NAME                                 TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)                      AGE
ingress-nginx-controller             LoadBalancer   10.96.210.139   10.200.16.11   80:32489/TCP,443:30936/TCP   88m
ingress-nginx-controller-admission   ClusterIP      10.96.128.101   &lt;none&gt;         443/TCP                      88m
</code></pre>
<p>ç»ˆäº<code>svc/ingress-nginx-controller</code>æ‹¿åˆ°äº†ä¸€ä¸ª<code>EXTERNAL-IP</code>, ç°åœ¨ä½ å°±å¯ä»¥å°†åŸŸåè§£æåˆ°<code>EXTERNAL-IP</code>, å¹¶é€šè¿‡è¿™ä¸ªåŸŸåæ¥è®¿é—®ä½ çš„åº”ç”¨äº†.(è€Œä¸”å®ƒå¿…é¡»æ˜¯èƒ½é€šè¿‡80è®¿é—®çš„.)ğŸ˜„</p>
<p>åŒæ—¶, è®©æˆ‘ä»¬æ¥çœ‹çœ‹ ingress å¯¹è±¡ä¿¡æ¯.</p>
<p>â­ï¸æˆ‘æš´æ¼çš„åº”ç”¨åœ¨ns: itä¸­.</p>
<pre><code class="language-bash">kubectl get ingress -n it
===
NAME                   CLASS    HOSTS          ADDRESS        PORTS   AGE 
test-it-local-ingress   &lt;none&gt;   test.it.local   10.200.16.11   80      106m
</code></pre>
<p>å¯ä»¥çœ‹åˆ°. ingress çš„ä¿¡æ¯ä¹Ÿæ›´æ–°äº†, å¹¶æ‹¿åˆ°äº† metallb çš„ä¸‹å‘çš„ip.</p>
<p>ä½ å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé€šè¿‡ ipvs è§„åˆ™æ¥çœ‹åˆ°è½¬å‘æƒ…å†µ.</p>
<pre><code class="language-bash">ipvsadm -L -n
===
TCP  10.200.16.11:80 rr
  -&gt; 10.97.2.57:80                Masq    1      0          0
TCP  10.200.16.11:443 rr
  -&gt; 10.97.2.57:443               Masq    1      0          0
</code></pre>
<p>è¿™é‡Œ 10.97.2.57 æ˜¯ ingress æ§åˆ¶å™¨çš„ pod ip.</p>
<p>å‡çº§</p>
<p><a target="_blank" rel="noopener" href="https://metallb.universe.tf/installation/#upgrade">https://metallb.universe.tf/installation/#upgrade</a></p>
<h2 id="nginx-ingress-æ§åˆ¶å™¨æš´æ¼é80å’Œé443ç«¯å£">nginx ingress æ§åˆ¶å™¨æš´æ¼é80å’Œé443ç«¯å£</h2>
<p><a target="_blank" rel="noopener" href="https://kubernetes.github.io/ingress-nginx/user-guide/exposing-tcp-udp-services/">https://kubernetes.github.io/ingress-nginx/user-guide/exposing-tcp-udp-services/</a></p>
<p>é»˜è®¤ä½ ä¼šå‘ç°ingressæ— æ³•æš´æ¼80å’Œ443ä¹‹å¤–çš„ç«¯å£.è¿™æ˜¯å› ä¸ºé»˜è®¤ingress-nginxå¹¶æ²¡æœ‰å¼€å¯4å±‚è½¬å‘.</p>
<h3 id="å¼€å¯ingress-nginxä¸­podçš„4å±‚è½¬å‘">å¼€å¯ingress-nginxä¸­podçš„4å±‚è½¬å‘</h3>
<p>æ£€æŸ¥ deployment: ingress-nginx ä¸­ pod æ¨¡æ¿æ˜¯å¦å¼€å¯äº†ä¸‹åˆ—å‚æ•°</p>
<pre><code class="language-bash">deploymentName=`kubectl get all -n ingress-nginx | grep deployment | awk '&#123;print $1&#125;'`
kubectl edit $&#123;deploymentName&#125; -n ingress-nginx
===
- args:
    - --tcp-services-configmap=$(POD_NAMESPACE)/tcp-services
    - --udp-services-configmap=$(POD_NAMESPACE)/udp-services
</code></pre>
<h3 id="åˆ›å»ºæš´æ¼ç«¯å£çš„é…ç½®æ–‡ä»¶">åˆ›å»ºæš´æ¼ç«¯å£çš„é…ç½®æ–‡ä»¶</h3>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: tcp-services
  namespace: ingress-nginx
data:
  8080: &quot;it/test-it-local-svc:8080&quot;
</code></pre>
<p>è¿™é‡Œ8080: &quot;it/test-it-local-svc:8080&quot;<code>ç¬¬ä¸€ä¸ª8080æŒ‡çš„æ˜¯ingress-nginxçš„podå¯¹è±¡é‡Œéœ€è¦ç›‘å¬çš„ç«¯å£, </code>it/test-it-local-svc:8080` æŒ‡çš„æ˜¯ns:itä¸‹çš„svcå¯¹è±¡test-it-local-svcçš„8080ç«¯å£</p>
<h3 id="æ·»åŠ æš´æ¼ç«¯å£åˆ°ingress-nginxä¸­svcå¯¹è±¡">æ·»åŠ æš´æ¼ç«¯å£åˆ°ingress-nginxä¸­svcå¯¹è±¡</h3>
<pre><code class="language-bash">kubectl get all -n ingress-nginx | grep service | awk '&#123;print $1&#125;' 
kubectl edit service/ingress-nginx-controller -n ingress-nginx
===
  - name: test-8080
    port: 8080
    protocol: TCP
    targetPort: 8080
</code></pre>
<p>ä¸‰æ­¥è¿‡å, ä¸å‡ºæ„å¤–, ä½ å°†å¯ä»¥é€šè¿‡ingress-nginxçš„podå¯¹è±¡ä¸­çš„nginx.confæ–‡ä»¶çœ‹åˆ°tcpçš„è½¬å‘é…ç½®.</p>
<pre><code class="language-bash">        # TCP services

        server &#123;
                preread_by_lua_block &#123;
                        ngx.var.proxy_upstream_name=&quot;tcp-it-test-it-local-svc-8080&quot;;
                &#125;

                listen                  8080;

                proxy_timeout           600s;
                proxy_pass              upstream_balancer;

        &#125;
</code></pre>

</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/posts/ae41ae33/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  ç›‘æ§â˜monit
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/posts/4bf29cf0/">
                k8sâ˜12-2æœ‰çŠ¶æ€æœåŠ¡StatefulSet
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>



	<div id="vcomments"></div>


<script>
	
		// è¯„è®º
		new Valine({
			av: AV,
			el: '#vcomments',
			notify: false,
			verify: false,
			path: window.location.pathname,
			appId: 'Sq2igagqhmGqvs3eHHtcNKiB-gzGzoHsz',
			appKey: 'cDTpqcpogeQq55SOuBHEXv9W',
			placeholder: 'å†™ç‚¹ä¸œè¥¿å§',
			avatar: 'retro',
			recordIP: false
		})
	
	
    // æ˜¾ç¤ºæ¬¡æ•°
		function showTime(Counter) {
			var query = new AV.Query("Counter");
			if($(".leancloud_visitors").length > 0){
				var url = $(".leancloud_visitors").attr('id').trim();
				// where field
				query.equalTo("words", url);
				// count
				query.count().then(function (number) {
					// There are number instances of MyClass where words equals url.
					$(document.getElementById(url)).text(number?  number : '--');
				}, function (error) {
					// error is an instance of AVError.
				});
			}
		}
		// è¿½åŠ pv
		function addCount(Counter) {
			var url = $(".leancloud_visitors").length > 0 ? $(".leancloud_visitors").attr('id').trim() : 'wujun234.github.io';
			var Counter = AV.Object.extend("Counter");
			var query = new Counter;
			query.save({
				words: url
			}).then(function (object) {
			})
		}
		$(function () {
			var Counter = AV.Object.extend("Counter");
			addCount(Counter);
			showTime(Counter);
		});
	
</script>
	</div>
	<div id="footer">
	<p>
	Â©2016-<span id="footerYear"></span> 
	<a href="/">zyh</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			pv
			<span id="busuanzi_value_site_pv"></span>
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			uv
			<span id="busuanzi_value_site_uv"></span>
		</span>
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>